<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Geophysics Playground · 期末作品集</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #020617;
      --bg-card: #0b1120;
      --accent: #fbbf24;
      --accent2: #38bdf8;
      --accent3: #a855f7;
      --text: #f9fafb;
      --muted: #9ca3af;
      --border: #1f2937;
      --danger: #fb7185;
      --success: #4ade80;
      --radius: 16px;
    }
    * {
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at top, #111827, #020617);
      color: var(--text);
    }
    .page {
      max-width: 1120px;
      margin: 0 auto;
      padding: 20px 14px 60px;
    }
    header {
      margin-bottom: 16px;
    }
    header h1 {
      margin: 0;
      font-size: 28px;
    }
    header p {
      margin: 4px 0 6px;
      color: var(--muted);
      font-size: 14px;
      max-width: 780px;
    }
    .tagline {
      font-style: italic;
      font-size: 13px;
      color: #e5e7eb;
    }
    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }
    .chip {
      border-radius: 999px;
      padding: 2px 10px;
      font-size: 11px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      color: var(--muted);
      background: rgba(15, 23, 42, 0.8);
    }

    .tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 10px 0 18px;
      border-bottom: 1px solid var(--border);
      padding-bottom: 4px;
      position: sticky;
      top: 0;
      background: linear-gradient(to bottom, rgba(2,6,23,0.97), rgba(2,6,23,0.9));
      backdrop-filter: blur(10px);
      z-index: 20;
    }
    .tab-btn {
      border: none;
      background: transparent;
      color: var(--muted);
      padding: 7px 14px;
      border-radius: 999px;
      font-size: 13px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 5px;
      transition: all 0.15s ease;
      white-space: nowrap;
    }
    .tab-btn span {
      font-size: 15px;
    }
    .tab-btn:hover {
      background: rgba(148, 163, 184, 0.16);
      color: var(--text);
    }
    .tab-btn.active {
      background: var(--accent);
      color: #111827;
      font-weight: 600;
    }

    .section {
      display: none;
      animation: fadeIn 0.25s ease;
    }
    .section.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(4px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .card {
      background: var(--bg-card);
      border-radius: var(--radius);
      padding: 16px 18px;
      border: 1px solid var(--border);
      margin-bottom: 14px;
      box-shadow: 0 14px 35px rgba(0,0,0,0.45);
    }

    h2 {
      margin: 0 0 8px;
      font-size: 20px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    h3 {
      margin: 4px 0 6px;
      font-size: 15px;
    }

    ul {
      margin: 4px 0 8px 18px;
      padding: 0;
      font-size: 14px;
      line-height: 1.7;
    }
    li { margin: 2px 0; }

    .pill {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(148,163,184,0.16);
      color: var(--muted);
      display: inline-block;
      margin-bottom: 4px;
    }

    .quote {
      border-left: 3px solid var(--accent2);
      padding-left: 10px;
      margin-top: 6px;
      color: var(--muted);
      font-size: 13px;
    }

    .two-col {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 10px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 3px;
      margin-bottom: 8px;
      font-size: 13px;
    }
    label {
      color: #e5e7eb;
      font-size: 13px;
    }
    input[type="number"],
    input[type="text"],
    select {
      background: #020617;
      border-radius: 999px;
      border: 1px solid var(--border);
      padding: 7px 10px;
      color: var(--text);
      font-size: 13px;
      outline: none;
    }
    input::placeholder {
      color: #6b7280;
    }

    button.primary {
      border-radius: 999px;
      border: none;
      padding: 8px 16px;
      font-size: 13px;
      cursor: pointer;
      background: linear-gradient(to right, #f97316, #facc15);
      color: #111827;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 4px;
    }
    button.primary:hover {
      filter: brightness(1.06);
      transform: translateY(-1px);
    }

    .result {
      margin-top: 6px;
      font-size: 13px;
      color: var(--accent2);
    }
    .result.good { color: var(--success); }
    .result.bad { color: var(--danger); }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 13px;
    }
    th, td {
      border: 1px solid #374151;
      padding: 6px 8px;
      text-align: left;
    }
    th {
      background: #111827;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      padding: 2px 9px;
      border-radius: 999px;
      background: rgba(56,189,248,0.12);
      color: var(--accent2);
      margin-left: 4px;
    }

    .accordion {
      margin-top: 4px;
    }
    .accordion-item {
      border-radius: 12px;
      border: 1px solid var(--border);
      margin-bottom: 6px;
      overflow: hidden;
      background: #020617;
    }
    .accordion-header {
      padding: 7px 10px;
      font-size: 13px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .accordion-header span {
      color: var(--muted);
    }
    .accordion-body {
      padding: 8px 10px 10px;
      display: none;
      font-size: 13px;
      color: var(--muted);
      border-top: 1px solid var(--border);
    }
    .accordion-item.open .accordion-body {
      display: block;
    }
    .accordion-item.open .accordion-header span {
      color: var(--accent2);
    }

    img.preview {
      max-width: 100%;
      border-radius: 10px;
      border: 1px solid #1f2937;
      margin-top: 10px;
    }

    @media(max-width: 640px) {
      header h1 { font-size: 22px; }
      .card { padding: 14px 12px; }
      .tabs { overflow-x: auto; }
    }
  </style>
</head>
<body>
<div class="page">
  <header>
    <h1>Geophysics Playground · 期末作品集</h1>
    <p class="tagline">從地球偵探社的入門關卡，到重力魔法、震測實戰與板塊地圖，一次把整學期的地球物理作業打包成互動網頁。</p>
    <p>
      下方分成四個頁籤：第一個是我的<strong>第一份作業</strong>「地球物理概論教具」，
      另外三個則是重力異常計算、校園震測實驗，以及 PyGMT 板塊邊界地圖。
      可以當成期末報告的線上作品集。
    </p>
    <div class="chips">
      <span class="chip">🌍 地球內外構造</span>
      <span class="chip">🧮 重力魔法</span>
      <span class="chip">🔨 校園震測</span>
      <span class="chip">🗺️ PyGMT 繪圖</span>
    </div>
  </header>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab-btn active" data-target="intro"><span>🏠</span>總覽</button>
    <button class="tab-btn" data-target="hw1"><span>📘</span>第一份作業：Geophysics Playground</button>
    <button class="tab-btn" data-target="gravity"><span>🪐</span>重力魔法：自由空間與布格異常</button>
    <button class="tab-btn" data-target="seismic"><span>🔨</span>校園震測實驗</button>
    <button class="tab-btn" data-target="plates"><span>🗺️</span>PyGMT 板塊邊界地圖</button>
  </div>

  <!-- Intro -->
  <section id="intro" class="section active">
    <div class="card">
      <h2>🏠 網頁導覽</h2>
      <span class="pill">怎麼使用這個作品集</span>
      <ul>
        <li><strong>總覽</strong>：快速理解四個作業彼此的關聯，知道這學期到底在玩什麼。</li>
        <li><strong>Geophysics Playground</strong>：第一份作業，把地球物理概念變成有 emoji、有小測驗的教具。</li>
        <li><strong>重力魔法</strong>：輸入觀測重力與高度，讓網頁幫你算自由空氣 & 布格重力異常。</li>
        <li><strong>校園震測</strong>：用簡化公式估算淺層厚度，感受一下「自己敲出來的地層」。</li>
        <li><strong>PyGMT 板塊邊界</strong>：展示用程式畫出的板塊邊界地圖，當作其他作業的構造背景。</li>
      </ul>
      <div class="quote">
        使用說明：點上方頁籤切換主題。每一頁都有至少一個可以玩的小工具，
        也附上精簡版文字說明，方便在期末報告時口頭講解。
      </div>
    </div>

    <div class="card">
      <h3>📚 四份作業怎麼串在一起？</h3>
      <div class="two-col">
        <div>
          <ul>
            <li><strong>從大到小：</strong>  
              Playground 說明地球整體構造與觀測方法 →  
              PyGMT 地圖畫出板塊邊界 →  
              校園震測看「腳下這一小塊」 →  
              重力異常則是介於兩者之間的區域尺度工具。</li>
            <li><strong>從理論到實作：</strong>  
              理論（第一份作業） ➝ 數值計算（重力） ➝ 現地量測（震測） ➝ 視覺化（PyGMT）。</li>
          </ul>
        </div>
        <div>
          <ul>
            <li><strong>從課本到網頁：</strong>  
              每一份作業原本是 PDF、程式或 HuggingFace Space，現在被整理成統一風格的互動網頁。</li>
            <li><strong>從被教到能教：</strong>  
              內容盡量用「我要怎麼跟別人解釋」的角度撰寫，希望看的人不一定是專業，也能跟上。</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- HW1 Playground -->
  <section id="hw1" class="section">
    <div class="card">
      <h2>📘 第一份作業：Geophysics Playground</h2>
      <span class="pill">地球偵探社 · 五張關卡卡片</span>
      <p style="font-size:14px;color:var(--muted);margin-top:6px;">
        這是我在本課的第一份作業：把地球物理基礎變成一套「入坑教具」。
        每一章都需要說得出核心概念、為什麼重要、生活例子，以及一句好記的口訣。
      </p>
    </div>

    <div class="card">
      <h3>1️⃣ 地球作為一顆行星</h3>
      <ul>
        <li>地球分層：地殼 → 地函 → 地核；外核對流是地磁場的發電機。</li>
        <li>地函：黏滯流動的固體，對流驅動板塊漂移。</li>
        <li>地核：半徑約 2900 公里，下方有固態內核。</li>
        <li>生活比喻：像一顆「洋蔥」，往裡越熱越密。</li>
      </ul>
      <div class="quote">
        口訣：「核最重、函在流、殻最輕。」—— 從內到外密度與狀態的變化。
      </div>
    </div>

    <div class="card">
      <h3>2️⃣ 重力與大地測量</h3>
      <ul>
        <li>地球不是完美球體，而是赤道較胖、兩極略扁的橢球。</li>
        <li>重力異常：觀測重力與理論值之差，可以反映地下密度結構。</li>
        <li>衛星任務（如 GRACE）可以量到冰川融化、地下水變化等質量重新分布。</li>
      </ul>
      <div class="quote">
        重力異常 ≒ 底下有沒有「偷偷藏東西」：高密度岩體、低密度盆地、構造根……。
      </div>
    </div>

    <div class="card">
      <h3>3️⃣ 地震學與地球內部</h3>
      <ul>
        <li>P 波：縱波、速度快、可穿液體；S 波：橫波、速度慢、不能穿液體。</li>
        <li>P-S 時差：可用來估算震源距離；全球地震站資料用來推回地核結構。</li>
        <li>地震警報：利用 P 波快、S 波慢的特性，爭取幾秒到十幾秒的時間。</li>
      </ul>
      <div class="quote">
        口訣：「P 快 S 慢、S 不過液、P-S 時差測距離。」—— 三件事全包。
      </div>
    </div>

    <div class="card">
      <h3>4️⃣ 年齡、熱與電性 & 5️⃣ 地磁與古地磁</h3>
      <div class="two-col">
        <div>
          <ul>
            <li>新生洋壳最熱、最薄、年紀最輕；遠離洋脊越老越冷越厚。</li>
            <li>海底熱流與海底年齡圖，支持板塊擴張與海底擴張理論。</li>
          </ul>
          <div class="quote">
            海底像「餅乾」：剛出爐時熱又薄，放久自然變冷變厚。
          </div>
        </div>
        <div>
          <ul>
            <li>地磁場 ≈ 巨大條形磁鐵；岩石在冷卻時會記錄下當時的磁場（古地磁）。</li>
            <li>海底磁條帶（交替正反磁化）是板塊擴張與磁極翻轉的重要證據。</li>
          </ul>
          <div class="quote">
            口訣：「岩石錄磁、條帶翻轉、追溯位置。」—— 古地磁就是追蹤板塊漂移的 GPS。
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>🧪 小測驗：P 波 / S 波誰不能在液體中傳播？</h3>
      <p style="font-size:13px;color:var(--muted);margin-bottom:6px;">
        試試看能不能回答這題——這也是第一份作業中的小互動之一。
      </p>
      <div style="font-size:13px;">
        <label><input type="radio" name="q1" value="P" /> 1. P 波</label><br/>
        <label><input type="radio" name="q1" value="S" /> 2. S 波</label><br/>
        <label><input type="radio" name="q1" value="both" /> 3. 兩者都可以</label>
      </div>
      <button class="primary" onclick="checkQuiz()">提交答案 ✅</button>
      <div id="quiz-result" class="result"></div>
    </div>
  </section>

  <!-- Gravity -->
  <section id="gravity" class="section">
    <div class="card">
      <h2>🪐 重力魔法課：自由空間與布格重力異常</h2>
      <span class="pill">Hogwarts of Geophysics · Faculty of Gravimancy</span>
      <p style="font-size:14px;color:var(--muted);margin-top:6px;">
        這一部分來自我做的重力異常計算作業。重點是學會：
        觀測重力如何從原始數值，經過自由空氣校正、布格校正，
        變成可以解讀地下密度構造的 free-air & Bouguer anomaly。
      </p>
    </div>

    <div class="card">
      <h3>📚 理論小抄</h3>
      <ul>
        <li><strong>自由空氣校正 (FAC)：</strong>只修正高度差；假設地面上方只有空氣。</li>
        <li><strong>自由空氣異常 Δg<sub>FA</sub>：</strong>觀測重力扣掉理論重力，再加上 FAC。</li>
        <li><strong>布格校正 (BC)：</strong>把「海平面到測站之間那塊岩石」的質量效應扣掉。</li>
        <li><strong>布格異常 Δg<sub>B</sub>：</strong>在 Δg<sub>FA</sub> 再扣掉 BC，較能反映地下密度異常。</li>
      </ul>
      <div class="quote">
        直覺版翻譯：<br/>
        Free-air：先假裝我們都站在同一高度。<br/>
        Bouguer：再把中間那座小山的重量也扣光，看看地球本體到底怪在哪裡。
      </div>
    </div>

    <div class="card">
      <h3>🧮 重力異常計算器（玩具版）<span class="badge">互動</span></h3>
      <p style="font-size:13px;color:var(--muted);">
        給四個數字就好：觀測重力 g<sub>obs</sub>、理論重力 g<sub>t</sub>、測站高度 h（m）、岩石密度 ρ（g/cm³）。
        這裡用簡化公式：
        <code>FAC ≈ 0.3086 · h</code> ，
        <code>BC ≈ 0.0419 · ρ · h</code>（mGal）。
      </p>
      <div class="two-col">
        <div>
          <div class="field">
            <label for="gobs">觀測重力 g_obs (mGal)</label>
            <input type="number" id="gobs" value="978120" />
          </div>
          <div class="field">
            <label for="gt">理論重力 g_t (mGal)</label>
            <input type="number" id="gt" value="978954.71" />
          </div>
        </div>
        <div>
          <div class="field">
            <label for="h">測站高度 h (m)</label>
            <input type="number" id="h" value="120" />
          </div>
          <div class="field">
            <label for="rho">岩石密度 ρ (g/cm³)</label>
            <input type="number" id="rho" value="2.67" step="0.01" />
          </div>
          <button class="primary" onclick="calcGravity()">施展高等咒語 · Calculate ✨</button>
        </div>
      </div>
      <div id="gravity-result" class="result"></div>

      <table>
        <thead>
          <tr><th>量</th><th>說明</th><th>計算結果 (mGal)</th></tr>
        </thead>
        <tbody>
          <tr><td>Δg<sub>FA</sub></td><td>自由空氣異常</td><td id="fa-cell">—</td></tr>
          <tr><td>Δg<sub>B</sub></td><td>布格異常</td><td id="bouguer-cell">—</td></tr>
          <tr><td>FAC</td><td>自由空氣校正</td><td id="fac-cell">—</td></tr>
          <tr><td>BC</td><td>布格校正</td><td id="bc-cell">—</td></tr>
        </tbody>
      </table>
      <div class="quote">
        參考：用預設值計算時，Δg<sub>FA</sub> 和 Δg<sub>B</sub> 會接近我原本作業裡的 −800 mGal 左右，
        是一個明顯的負異常案例。
      </div>
    </div>
  </section>

  <!-- Seismic -->
  <section id="seismic" class="section">
    <div class="card">
      <h2>🔨 校園震測實驗：從敲鐵板到地層厚度</h2>
      <span class="pill">黑森林 → 圖書館後方 · 淺層震測</span>
      <p style="font-size:14px;color:var(--muted);margin-top:6px;">
        這一部分是我和組員一起完成的震測實驗報告：
        在校園拉出一條測線、插上 24 支地震儀，用鐵鎚敲鐵板製造「小地震」，
        再從走時圖反算出淺層地層的波速與厚度。
      </p>
    </div>

    <div class="card">
      <h3>🧰 實驗流程摘要</h3>
      <div class="two-col">
        <div>
          <h4 style="font-size:14px;margin:4px 0;">1️⃣ 架設測線</h4>
          <ul>
            <li>沿直線每隔固定距離擺 1 支 geophone（共 24 支）。</li>
            <li>用皮尺量距，並把所有儀器接回資料記錄器。</li>
          </ul>
          <h4 style="font-size:14px;margin:4px 0;">2️⃣ 震源操作</h4>
          <ul>
            <li>在測線端點的鐵板上敲擊，產生震源。</li>
            <li>移動震源位置重複量測，累積多個炸點資料。</li>
          </ul>
        </div>
        <div>
          <h4 style="font-size:14px;margin:4px 0;">3️⃣ 走時圖分析</h4>
          <ul>
            <li>在走時圖上選出直達波與折射波的到時。</li>
            <li>利用斜率估算第一層、第二層波速。</li>
            <li>利用臨界折射幾何，推算上層厚度。</li>
          </ul>
          <div class="quote">
            心得：真正困難的不是公式，而是「這條線到底要怎麼畫」，
            每一個點都藏著雜訊、眼力和判斷。
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>📏 厚度估算玩具<span class="badge">互動</span></h3>
      <p style="font-size:13px;color:var(--muted);">
        給一個簡化版二層模型：上層速度 V1、下層速度 V2，在臨界距離附近量到折射波和直達波的走時差 Δt，
        可以用近似：
        <code>h ≈ (Δt · V1 · V2) / (2 · (V2 − V1))</code>。
      </p>
      <div class="two-col">
        <div>
          <div class="field">
            <label for="v1">上層速度 V1 (km/s)</label>
            <input type="number" id="v1" value="0.4" step="0.01" />
          </div>
          <div class="field">
            <label for="v2">下層速度 V2 (km/s)</label>
            <input type="number" id="v2" value="1.5" step="0.01" />
          </div>
        </div>
        <div>
          <div class="field">
            <label for="dt">臨界距離附近走時差 Δt (s)</label>
            <input type="number" id="dt" value="0.04" step="0.001" />
          </div>
          <button class="primary" onclick="calcThickness()">估算上層厚度 📐</button>
          <div id="thick-result" class="result"></div>
        </div>
      </div>
      <div class="quote">
        注意：這只是示意模型，實際報告中是用完整走時圖、多個炸點與統計處理得到厚度，
        但玩過一次之後，就比較不會把「厚度反算」當成黑魔法。
      </div>
    </div>

    <div class="card">
      <h3>🧠 實驗反思（摘要版）</h3>
      <ul>
        <li>從只看課本示意圖，到自己拉線、接線、敲鐵板，對震測的理解變立體很多。</li>
        <li>資料處理的難度，讓我重新尊重「好數據」的珍貴——震源不穩、雜訊太大都會直接反映在走時圖上。</li>
        <li>和夥伴的分工協作（有人負責現場、有人負責整理、有人負責解讀）其實就是小型研究團隊的縮影。</li>
      </ul>
    </div>
  </section>

  <!-- Plates -->
  <section id="plates" class="section">
    <div class="card">
      <h2>🗺️ PyGMT 板塊邊界地圖</h2>
      <span class="pill">plot_plate_boundary_pygmt · 讓程式畫出構造背景</span>
      <p style="font-size:14px;color:var(--muted);margin-top:6px;">
        這份作業是用 PyGMT 產生板塊邊界地圖。雖然程式在 GitHub 上，
        但在期末報告裡，我希望它扮演的是「把全世界構造一次看清楚」的背景地圖角色。
      </p>
    </div>

    <div class="card">
      <h3>🧭 地圖設計要素</h3>
      <div class="two-col">
        <div>
          <ul>
            <li>Region：可以是全球，也可以是某個局部區域（例如台灣周邊、環太平洋）。</li>
            <li>Projection：依用途選擇 Mercator、Mollweide 等投影。</li>
            <li>底圖：陸地／海洋填色、海岸線、等高線或海底地形。</li>
          </ul>
        </div>
        <div>
          <ul>
            <li>板塊邊界資料：讀入現成 dataset（例如全球板塊邊界檔）作為 polyline 繪製。</li>
            <li>地圖配件：比例尺、方向標、色階條、標註主要板塊名稱。</li>
          </ul>
        </div>
      </div>
      <div class="quote">
        心得：一開始只是「學會讓 PyGMT 不報錯」，後來慢慢變成會調投影、顏色和圖例，
        發現產圖美感也是地球物理的戰力之一。
      </div>
    </div>

    <div class="card">
      <h3>📷 地圖預覽（請替換成自己的圖片）</h3>
      <p style="font-size:13px;color:var(--muted);">
        把你用 PyGMT 產出的圖檔（例如 <code>plate_boundary_world.png</code>）放到跟這個 HTML 同一個資料夾，
        然後把下方 <code>src</code> 換成自己的檔名即可。
      </p>
      <!-- 把 plate_boundary_world.png 改成自己的圖檔名 -->
      <img src="plate_boundary_world.png" alt="Global plate boundary map" class="preview" />
    </div>

    <div class="card">
      <h3>📂 細部說明（點開看）</h3>
      <div class="accordion">
        <div class="accordion-item">
          <div class="accordion-header" onclick="toggleAccordion(this)">
            <span>全球視角：板塊種類與邊界型態</span><span>＋</span>
          </div>
          <div class="accordion-body">
            <ul>
              <li>可在圖上標註發散型邊界（中洋脊）、聚合型邊界（俯衝帶、碰撞帶）、保守型邊界（走滑斷層）。</li>
              <li>搭配地震分布或火山位置，可以快速看出「地球哪裡比較忙」。</li>
            </ul>
          </div>
        </div>
        <div class="accordion-item">
          <div class="accordion-header" onclick="toggleAccordion(this)">
            <span>區域視角：與其他作業的連結</span><span>＋</span>
          </div>
          <div class="accordion-body">
            <ul>
              <li>可以把校園震測的位置、重力異常測區，放到更大的板塊構造背景裡看：  
                  例如：我們的校園在島弧？在碰撞帶？在被拉裂的邊緣？</li>
              <li>這樣在報告裡就能從「全球板塊」一路講到「學校地底下的那幾公尺」。</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<script>
  // Tab switching
  const tabButtons = document.querySelectorAll(".tab-btn");
  const sections = document.querySelectorAll(".section");

  tabButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      const target = btn.dataset.target;
      tabButtons.forEach(b => b.classList.remove("active"));
      sections.forEach(s => s.classList.remove("active"));
      btn.classList.add("active");
      document.getElementById(target).classList.add("active");
      window.scrollTo({ top: 0, behavior: "smooth" });
    });
  });

  // Quiz
  function checkQuiz() {
    const selected = document.querySelector("input[name='q1']:checked");
    const r = document.getElementById("quiz-result");
    if (!selected) {
      r.textContent = "先選一個答案，再按提交。";
      r.className = "result bad";
      return;
    }
    if (selected.value === "S") {
      r.textContent = "答對了！S 波不能在液體中傳播，這也是我們知道外核是液態的關鍵之一。";
      r.className = "result good";
    } else {
      r.textContent = "再想想：真正不能穿過液體的是 S 波（剪切波），P 波是可以的。";
      r.className = "result bad";
    }
  }

  // Gravity calculator
  function calcGravity() {
    const gobs = parseFloat(document.getElementById("gobs").value);
    const gt = parseFloat(document.getElementById("gt").value);
    const h = parseFloat(document.getElementById("h").value);
    const rho = parseFloat(document.getElementById("rho").value);
    const res = document.getElementById("gravity-result");

    if (isNaN(gobs) || isNaN(gt) || isNaN(h) || isNaN(rho)) {
      res.textContent = "請確認四個欄位都有填數字。";
      res.className = "result bad";
      return;
    }
    const FAC = 0.3086 * h;          // mGal
    const BC = 0.0419 * rho * h;     // mGal
    const dFA = gobs - gt + FAC;
    const dB = dFA - BC;

    document.getElementById("fac-cell").textContent = FAC.toFixed(2);
    document.getElementById("bc-cell").textContent = BC.toFixed(2);
    document.getElementById("fa-cell").textContent = dFA.toFixed(2);
    document.getElementById("bouguer-cell").textContent = dB.toFixed(2);

    let typeFA = dFA > 0 ? "正異常（可能有高密度體，如基盤或岩株）" : "負異常（可能是低密度區，如沉積盆地）";
    let typeB = dB > 0 ? "正布格異常" : "負布格異常";
    res.textContent =
      `自由空氣異常 Δg_FA = ${dFA.toFixed(2)} mGal → ${typeFA}；` +
      `布格異常 Δg_B = ${dB.toFixed(2)} mGal → ${typeB}。`;
    res.className = "result";
  }

  // Thickness calculator
  function calcThickness() {
    const v1 = parseFloat(document.getElementById("v1").value); // km/s
    const v2 = parseFloat(document.getElementById("v2").value);
    const dt = parseFloat(document.getElementById("dt").value);
    const r = document.getElementById("thick-result");

    if (isNaN(v1) || isNaN(v2) || isNaN(dt) || v2 <= v1) {
      r.textContent = "請輸入合理的 V1、V2、Δt（而且 V2 要大於 V1）。";
      r.className = "result bad";
      return;
    }
    // convert km/s to m/s in formula or直接用 km/s 與 s，厚度會以 km 為單位
    const h = (dt * v1 * v2) / (2 * (v2 - v1)); // 單位：km
    r.textContent = `估算得到的上層厚度約為 ${h.toFixed(3)} km（約 ${ (h*1000).toFixed(1) } 公尺）。`;
    r.className = "result";
  }

  // Accordion
  function toggleAccordion(headerEl) {
    const item = headerEl.parentElement;
    const open = item.classList.contains("open");
    document.querySelectorAll(".accordion-item").forEach(i => i.classList.remove("open"));
    if (!open) item.classList.add("open");
  }
</script>
</body>
</html>
